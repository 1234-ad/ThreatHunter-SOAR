# ThreatHunter-SOAR Environment Configuration
# Copy this file to .env and update with your actual values

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
DATABASE_URL=postgresql://soar_user:secure_password_123@postgres:5432/threathunter_soar
DB_HOST=postgres
DB_PORT=5432
DB_NAME=threathunter_soar
DB_USER=soar_user
DB_PASSWORD=secure_password_123

# ============================================================================
# REDIS CONFIGURATION
# ============================================================================
REDIS_URL=redis://:redis_password_123@redis:6379/0
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=redis_password_123

# ============================================================================
# APPLICATION CONFIGURATION
# ============================================================================
SECRET_KEY=your-super-secret-key-change-this-in-production-min-32-chars
DEBUG=false
ENVIRONMENT=production
API_VERSION=v1
CORS_ORIGINS=http://localhost:3000,http://localhost:3001,https://yourdomain.com

# ============================================================================
# THREAT INTELLIGENCE API KEYS
# ============================================================================
VIRUSTOTAL_API_KEY=your_virustotal_api_key_here
ABUSEIPDB_API_KEY=your_abuseipdb_api_key_here
OTX_API_KEY=your_alienvault_otx_api_key_here
SHODAN_API_KEY=your_shodan_api_key_here
MISP_URL=https://your-misp-instance.com
MISP_API_KEY=your_misp_api_key_here

# ============================================================================
# EMAIL CONFIGURATION
# ============================================================================
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_TLS=true
EMAIL_FROM=noreply@threathunter-soar.local

# ============================================================================
# NOTIFICATION CHANNELS
# ============================================================================
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
TEAMS_WEBHOOK_URL=https://outlook.office.com/webhook/YOUR/TEAMS/WEBHOOK
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/DISCORD/WEBHOOK

# ============================================================================
# SECURITY CONFIGURATION
# ============================================================================
JWT_SECRET_KEY=your-jwt-secret-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24
PASSWORD_MIN_LENGTH=8
SESSION_TIMEOUT_MINUTES=480

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=/app/logs/threathunter-soar.log
ENABLE_AUDIT_LOG=true
AUDIT_LOG_FILE=/app/logs/audit.log

# ============================================================================
# ELASTICSEARCH CONFIGURATION
# ============================================================================
ELASTICSEARCH_URL=http://elasticsearch:9200
ELASTICSEARCH_INDEX_PREFIX=threathunter-soar
ELASTICSEARCH_USERNAME=
ELASTICSEARCH_PASSWORD=

# ============================================================================
# MONITORING CONFIGURATION
# ============================================================================
PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
GRAFANA_ADMIN_PASSWORD=admin123
ENABLE_METRICS=true
METRICS_PORT=8001

# ============================================================================
# ML MODEL CONFIGURATION
# ============================================================================
ML_MODEL_PATH=/app/models
ML_TRAINING_ENABLED=true
ML_RETRAIN_INTERVAL_HOURS=24
ML_CONFIDENCE_THRESHOLD=0.7
FEATURE_EXTRACTION_ENABLED=true

# ============================================================================
# YARA CONFIGURATION
# ============================================================================
YARA_RULES_PATH=/app/rules/yara
YARA_UPDATE_INTERVAL_HOURS=6
YARA_CUSTOM_RULES_ENABLED=true

# ============================================================================
# INCIDENT RESPONSE CONFIGURATION
# ============================================================================
AUTO_INCIDENT_CREATION=true
AUTO_PLAYBOOK_EXECUTION=true
INCIDENT_RETENTION_DAYS=365
EVIDENCE_RETENTION_DAYS=2555  # 7 years
MAX_CONCURRENT_PLAYBOOKS=5

# ============================================================================
# NETWORK CONFIGURATION
# ============================================================================
NETWORK_SCAN_ENABLED=true
NETWORK_SCAN_TIMEOUT=300
ASSET_DISCOVERY_ENABLED=true
VULNERABILITY_SCAN_ENABLED=false

# ============================================================================
# BACKUP CONFIGURATION
# ============================================================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_LOCATION=/app/backups

# ============================================================================
# RATE LIMITING
# ============================================================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_BURST=20

# ============================================================================
# EXTERNAL INTEGRATIONS
# ============================================================================
SIEM_INTEGRATION_ENABLED=false
SIEM_TYPE=splunk  # splunk, qradar, sentinel
SIEM_URL=https://your-siem-instance.com
SIEM_API_KEY=your_siem_api_key

EDR_INTEGRATION_ENABLED=false
EDR_TYPE=crowdstrike  # crowdstrike, sentinelone, defender
EDR_API_URL=https://api.crowdstrike.com
EDR_CLIENT_ID=your_edr_client_id
EDR_CLIENT_SECRET=your_edr_client_secret

FIREWALL_INTEGRATION_ENABLED=false
FIREWALL_TYPE=paloalto  # paloalto, fortinet, checkpoint
FIREWALL_API_URL=https://your-firewall.com/api
FIREWALL_API_KEY=your_firewall_api_key

# ============================================================================
# DEVELOPMENT CONFIGURATION (Development only)
# ============================================================================
DEV_MODE=false
DEV_RELOAD=false
DEV_MOCK_EXTERNAL_APIS=false
DEV_SAMPLE_DATA=false

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================
WORKER_PROCESSES=4
WORKER_CONNECTIONS=1000
MAX_REQUEST_SIZE=100MB
REQUEST_TIMEOUT=300
KEEPALIVE_TIMEOUT=65

# ============================================================================
# FEATURE FLAGS
# ============================================================================
ENABLE_THREAT_HUNTING=true
ENABLE_AUTOMATED_RESPONSE=true
ENABLE_ML_DETECTION=true
ENABLE_BEHAVIORAL_ANALYSIS=true
ENABLE_THREAT_INTELLIGENCE=true
ENABLE_FORENSICS=true
ENABLE_REPORTING=true

# ============================================================================
# COMPLIANCE CONFIGURATION
# ============================================================================
COMPLIANCE_MODE=false
GDPR_COMPLIANCE=false
HIPAA_COMPLIANCE=false
SOX_COMPLIANCE=false
DATA_RETENTION_POLICY=standard

# ============================================================================
# CUSTOM CONFIGURATION
# ============================================================================
ORGANIZATION_NAME=Your Organization
ORGANIZATION_DOMAIN=yourdomain.com
SOC_CONTACT_EMAIL=soc@yourdomain.com
INCIDENT_ESCALATION_EMAIL=escalation@yourdomain.com
EMERGENCY_CONTACT=+1-555-123-4567